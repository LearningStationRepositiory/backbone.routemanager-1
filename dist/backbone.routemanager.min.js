(function(a){"use strict";var b=a.Backbone,c=a._,d=a.$,e=b.Router.extend({constructor:function(a){var d=this,e={},f=this.routers={},g=a.routes||this.routes;return c.each(g,function(g,h){var i,j,k,l;i=a.prefix,i||(i=h||""),i[i.length-1]==="/"?i=i.slice(0,i.length-1):i&&(i+="/");if(g.prototype instanceof b.Router)j=g.prototype.constructor,l=g.extend({constructor:function(a){var d=b.Router.prototype.constructor;return c.each(this.routes,function(a,b){delete this.routes[b],b=b?i+"/"+b:i,this.routes[b]=a},this),d.apply(this,arguments)}}),k=f[h]=new l,k.__manager__={},c.isFunction(j)&&j.call(k),k.__manager__.prefix=i;else if(c.isString(g)&&c.isString(h)){d[g]=a[g],delete a[g];if(h)return e[i+h]=g;e[i]=g}}),this.routes=e,b.Router.prototype.constructor.call(this)},navigate:function(a,c){b.history.navigate(a,c)}},{configure:function(a){var d=b.RouteManager.prototype.options;if(c.isObject(a))return c.extend(d,a)}});e.prototype.options={deferred:function(){return d.Deferred()}},b.RouteManager=e})(this)